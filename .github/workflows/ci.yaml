name: 🚀 Spring Boot CI - Authenmedaf

# 👉 Le workflow s’exécute uniquement lors d’un push sur la branche "main"
on:
  push:
    branches:
      - main

jobs:
  build:
    name: 🧱 Build et Test du projet
    runs-on: windows-latest

    steps:
      # 🪄 Étape 1 : Récupérer le code source du dépôt
      - name: 📦 Checkout du dépôt
        uses: actions/checkout@v4

      # ☕ Étape 2 : Installer Java 17
      - name: ⚙️ Configurer Java 17 (Temurin)
        uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "17"
          cache: "maven"

      # 🏗️ Étape 3 : Construire l’application avec Maven
      - name: 🧰 Build du projet avec Maven
        run: mvn -B clean package --file pom.xml

      # 🧪 Étape 4 : Lancer les tests unitaires
      - name: 🧠 Exécution des tests unitaires
        run: mvn test

      # 📤 Étape 5 : Sauvegarder le fichier JAR généré
      - name: 💾 Sauvegarder le JAR généré
        uses: actions/upload-artifact@v4
        with:
          name: authenmedaf-jar
          path: target/*.jar
